<div class="modal-overlay" *ngIf="visible">
  <div class="modal-container">
    <h3 class="modal-title">{{ couponData ? 'Edit Coupon' : 'Add Coupon' }}</h3>

    <form [formGroup]="couponForm" (ngSubmit)="submitForm()">
      <!-- Name -->
      <label>Name:</label>
      <input type="text" formControlName="name" class="form-control" />
      <div *ngIf="couponForm.get('name')?.touched && couponForm.get('name')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('name')?.errors?.['required']">Name is required.</small>
        <small *ngIf="couponForm.get('name')?.errors?.['pattern']">Enter a valid name.</small>
      </div>

      <!-- Code -->
      <label>Code:</label>
      <input type="text" formControlName="code" class="form-control" />
      <div *ngIf="couponForm.get('code')?.touched && couponForm.get('code')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('code')?.errors?.['required']">Code is required.</small>
        <small *ngIf="couponForm.get('code')?.errors?.['pattern']">No spaces allowed in code.</small>
      </div>

      <!-- Start Date -->
      <label>Start Date:</label>
      <input type="date" formControlName="startDate" class="form-control" />
      <div *ngIf="couponForm.get('startDate')?.touched && couponForm.get('startDate')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('startDate')?.errors?.['required']">Start date is required.</small>
      </div>

      <!-- End Date -->
      <label>End Date:</label>
      <input type="date" formControlName="endDate" class="form-control" />
      <div *ngIf="couponForm.get('endDate')?.touched && couponForm.get('endDate')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('endDate')?.errors?.['required']">End date is required.</small>
      </div>
      <div *ngIf="couponForm.errors?.['dateRangeInvalid']" class="text-danger">
        <small>End date must be after start date.</small>
      </div>

      <!-- Max Count -->
      <label>Max Count:</label>
      <input type="number" formControlName="maxCount" class="form-control" min="0" />
      <div *ngIf="couponForm.get('maxCount')?.touched && couponForm.get('maxCount')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('maxCount')?.errors?.['required']">Max count is required.</small>
        <small *ngIf="couponForm.get('maxCount')?.errors?.['min']">Value must be greater than 0.</small>
        <small *ngIf="couponForm.get('maxCount')?.errors?.['pattern']">Enter a valid number.</small>
      </div>

      <!-- Minimum Limit -->
      <label>Minimum Limit (₹):</label>
      <input type="number" formControlName="limitAmount" class="form-control" min="0" />
      <div *ngIf="couponForm.get('limitAmount')?.touched && couponForm.get('limitAmount')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('limitAmount')?.errors?.['required']">Minimum limit is required.</small>
        <small *ngIf="couponForm.get('limitAmount')?.errors?.['min']">Value must be greater than 0.</small>
        <small *ngIf="couponForm.get('limitAmount')?.errors?.['pattern']">Enter a valid number.</small>
      </div>

      <!-- Coupon Amount -->
      <label>Coupon Amount (₹):</label>
      <input type="number" formControlName="couponAmount" class="form-control" min="0" />
      <div *ngIf="couponForm.get('couponAmount')?.touched && couponForm.get('couponAmount')?.invalid" class="text-danger">
        <small *ngIf="couponForm.get('couponAmount')?.errors?.['required']">Coupon amount is required.</small>
        <small *ngIf="couponForm.get('couponAmount')?.errors?.['min']">Value must be greater than 0.</small>
        <small *ngIf="couponForm.get('couponAmount')?.errors?.['pattern']">Enter a valid number.</small>
      </div>

      <!-- Actions -->
      <div class="modal-actions">
        <button type="submit" class="submit-button" [disabled]="couponForm.invalid">
          {{ couponData ? 'Update' : 'Add' }}
        </button>
        <button type="button" class="submit-button cancel-btn" (click)="close()">Cancel</button>
      </div>
    </form>
  </div>
</div>

